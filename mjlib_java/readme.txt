由网友ak从c#版转写而来，感谢!